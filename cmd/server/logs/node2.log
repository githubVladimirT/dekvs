2026/02/07 19:03:35 Rollback failed: tx closed
2026/02/07 19:03:35 Rollback failed: tx closed
2026/02/07 19:03:35 Rollback failed: tx closed
2026-02-07T19:03:35.782+0300 [INFO]  raft: initial configuration: index=0 servers=[]
2026/02/07 19:03:35 Attempting to join cluster via 127.0.0.1:13001
2026-02-07T19:03:35.782+0300 [INFO]  raft: entering follower state: follower="Node at 127.0.0.1:12002 [Follower]" leader-address= leader-id=
2026/02/07 19:03:35 Successfully joined cluster
2026/02/07 19:03:35 Server starting: node=node2 raft=127.0.0.1:12002 grpc=127.0.0.1:13002
2026/02/07 19:03:35 Rollback failed: tx closed
2026-02-07T19:03:35.786+0300 [WARN]  raft: failed to get previous log: previous-index=3 last-index=0 error="log not found"
2026/02/07 19:03:35 Rollback failed: tx closed
2026/02/07 19:03:37 Rollback failed: tx closed
2026-02-07T19:03:49.980+0300 [WARN]  raft: rejecting pre-vote request since we have a leader: from=127.0.0.1:12003 leader=127.0.0.1:12001 leader-id=node1
2026-02-07T19:03:50.007+0300 [WARN]  raft: heartbeat timeout reached, starting election: last-leader-addr=127.0.0.1:12001 last-leader-id=node1
2026-02-07T19:03:50.007+0300 [INFO]  raft: entering candidate state: node="Node at 127.0.0.1:12002 [Candidate]" term=3
2026-02-07T19:03:50.008+0300 [ERROR] raft: failed to make requestVote RPC: target="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused" term=3
2026-02-07T19:03:50.009+0300 [INFO]  raft: pre-vote successful, starting election: term=3 tally=2 refused=1 votesNeeded=2
2026/02/07 19:03:50 Rollback failed: tx closed
2026-02-07T19:03:50.010+0300 [ERROR] raft: failed to make requestVote RPC: target="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused" term=3
2026/02/07 19:03:50 Rollback failed: tx closed
2026/02/07 19:03:50 Rollback failed: tx closed
2026-02-07T19:03:50.015+0300 [INFO]  raft: election won: term=3 tally=2
2026-02-07T19:03:50.015+0300 [INFO]  raft: entering leader state: leader="Node at 127.0.0.1:12002 [Leader]"
2026-02-07T19:03:50.015+0300 [INFO]  raft: added peer, starting replication: peer=node1
2026-02-07T19:03:50.015+0300 [INFO]  raft: added peer, starting replication: peer=node3
2026-02-07T19:03:50.015+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.015+0300 [INFO]  raft: pipelining replication: peer="{Voter node3 127.0.0.1:12003}"
2026/02/07 19:03:50 Rollback failed: tx closed
2026-02-07T19:03:50.026+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.092+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=10ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.103+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.158+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=10ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.179+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.248+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=10ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.266+0300 [WARN]  raft: failed to contact: server-id=node1 time=251.606606ms
2026-02-07T19:03:50.273+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.352+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=20ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.446+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.454+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=40ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.513+0300 [WARN]  raft: failed to contact: server-id=node1 time=498.097743ms
2026-02-07T19:03:50.582+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=80ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.662+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.726+0300 [WARN]  raft: failed to contact: server-id=node1 time=711.520639ms
2026-02-07T19:03:50.740+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=160ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:50.964+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:51.035+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:51.310+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:51.618+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:51.735+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:51.965+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:52.306+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:52.653+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:52.999+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:53.098+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node1 127.0.0.1:12001}" error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:53.321+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:53.632+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:53.947+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12001 backoff time=250ms error="dial tcp 127.0.0.1:12001: connect: connection refused"
2026-02-07T19:03:55.721+0300 [INFO]  raft: pipelining replication: peer="{Voter node1 127.0.0.1:12001}"
2026/02/07 19:05:23 Shutting down gracefully...
2026/02/07 19:05:23 Removing node node2 from cluster
2026-02-07T19:05:23.048+0300 [INFO]  raft: updating configuration: command=RemoveServer server-id=node2 server-addr= servers="[{Suffrage:Voter ID:node1 Address:127.0.0.1:12001} {Suffrage:Voter ID:node3 Address:127.0.0.1:12003}]"
2026/02/07 19:05:23 Rollback failed: tx closed
2026-02-07T19:05:23.058+0300 [INFO]  raft: aborting pipeline replication: peer="{Voter node3 127.0.0.1:12003}"
2026-02-07T19:05:23.110+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12003 backoff time=10ms error=EOF
2026-02-07T19:05:23.153+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node3 127.0.0.1:12003}" error="dial tcp 127.0.0.1:12003: connect: connection refused"
2026-02-07T19:05:23.217+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12003 backoff time=10ms error="dial tcp 127.0.0.1:12003: connect: connection refused"
2026-02-07T19:05:23.230+0300 [ERROR] raft: failed to appendEntries to: peer="{Voter node3 127.0.0.1:12003}" error="dial tcp 127.0.0.1:12003: connect: connection refused"
2026-02-07T19:05:23.301+0300 [ERROR] raft: failed to heartbeat to: peer=127.0.0.1:12003 backoff time=10ms error="dial tcp 127.0.0.1:12003: connect: connection refused"
2026-02-07T19:05:23.308+0300 [WARN]  raft: failed to contact: server-id=node3 time=250.500325ms
2026-02-07T19:05:23.308+0300 [WARN]  raft: failed to contact quorum of nodes, stepping down
2026-02-07T19:05:23.308+0300 [INFO]  raft: entering follower state: follower="Node at 127.0.0.1:12002 [Follower]" leader-address= leader-id=
2026/02/07 19:05:23 Failed to remove node: leadership lost while committing log
2026-02-07T19:05:23.308+0300 [INFO]  raft: aborting pipeline replication: peer="{Voter node1 127.0.0.1:12001}"
